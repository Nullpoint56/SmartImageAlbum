sequenceDiagram
  autonumber
  participant Client
  participant API as API Service
  participant OBJ as Object Store
  participant COORD as Coordinator Service
  participant EMBED as Embedding Service
  participant VECTOR as Vector DB
  participant STATUS as Workflow DB

  Client->>API: POST /images/upload
  API->>OBJ: Upload image to Object Store
  API->>COORD: Submit processing job

  COORD->>STATUS: Create job: status = "created", state = "none"
  COORD->>STATUS: Update status = "pending", state = "embedding"
  COORD->>EMBED: Send image to embed

  EMBED->>OBJ: Download image
  EMBED->>COORD: Return embedding vector

  COORD->>STATUS: Update state = "indexing"
  COORD->>VECTOR: Insert vector
  COORD->>STATUS: Update status = "done", state = "completed"
